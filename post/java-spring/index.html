<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <script type="application/ld+json">

{  
  "@context":"http://schema.org",
  "@type":"Website",
  "@id":"https:\/\/ivanhan0511.github.io\/",
  "author": {
    "@type": "Person",
    "name": "Ivan Han",
    
    "image": "https://www.gravatar.com/avatar/0cac315e34e792213d5fa694dc39777b"
    
  },
  "name":"Ivan Blog",
  "description":"\u003cp\u003eThis is a custom summary and does \u003cem\u003eNOT\u003c\/em\u003e appear in the post.\u003c\/p\u003e",
  "url":"https:\/\/ivanhan0511.github.io\/post\/java-spring\/",
  "keywords":"[java, spring, bean, ioc, aop, Ivan, SoftwareEngineer, C\/C\u002b\u002b, Java, Coffee, Bass, Bicycle, Badminton]"
}

</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.123.7 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="Ivan Han">
<meta name="keywords" content="java, spring, bean, ioc, aop, Ivan, SoftwareEngineer, C/C&#43;&#43;, Java, Coffee, Bass, Bicycle, Badminton">
<meta name="description" content="This is a custom summary and does NOT appear in the post.">


<meta property="og:description" content="This is a custom summary and does NOT appear in the post.">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring">
<meta name="twitter:title" content="Spring">
<meta property="og:url" content="https://ivanhan0511.github.io/post/java-spring/">
<meta property="twitter:url" content="https://ivanhan0511.github.io/post/java-spring/">
<meta property="og:site_name" content="Ivan Blog">
<meta property="og:description" content="This is a custom summary and does NOT appear in the post.">
<meta name="twitter:description" content="This is a custom summary and does NOT appear in the post.">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2024-10-26T11:22:00">
  
  
    <meta property="article:modified_time" content="2024-10-26T11:22:00">
  
  
  
    
      <meta property="article:section" content="Java">
    
      <meta property="article:section" content="WebFramework">
    
  
  
    
      <meta property="article:tag" content="Java">
    
      <meta property="article:tag" content="Spring">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@ivanhan0511">


  <meta name="twitter:creator" content="@ivanhan0511">






  <meta property="og:image" content="https://www.gravatar.com/avatar/0cac315e34e792213d5fa694dc39777b?s=640">
  <meta property="twitter:image" content="https://www.gravatar.com/avatar/0cac315e34e792213d5fa694dc39777b?s=640">




  <meta property="og:image" content="https://ivanhan0511.github.io/image-2.png">
  <meta property="twitter:image" content="https://ivanhan0511.github.io/image-2.png">


  <meta property="og:image" content="https://ivanhan0511.github.io/image-1.png">
  <meta property="twitter:image" content="https://ivanhan0511.github.io/image-1.png">


    <title>Spring</title>

    <link rel="icon" href="https://ivanhan0511.github.io/favicon.png">
    

    

    <link rel="canonical" href="https://ivanhan0511.github.io/post/java-spring/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    
    
    <link rel="stylesheet" href="https://ivanhan0511.github.io/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://ivanhan0511.github.io/" aria-label="Go to homepage">Ivan Blog</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://ivanhan0511.github.io/#about" aria-label="Open the link: /#about">
    
    
    
      
        <img class="header-picture" src="https://www.gravatar.com/avatar/0cac315e34e792213d5fa694dc39777b?s=90" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://ivanhan0511.github.io/#about" aria-label="Read more about the author">
          <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/0cac315e34e792213d5fa694dc39777b?s=110" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Ivan Han</h4>
        
          <h5 class="sidebar-profile-bio">I need <strong>slow down</strong></h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://ivanhan0511.github.io/" title="Home">
    
      <i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://ivanhan0511.github.io/categories" title="Categories">
    
      <i class="sidebar-button-icon fas fa-lg fa-bookmark" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://ivanhan0511.github.io/tags" title="Tags">
    
      <i class="sidebar-button-icon fas fa-lg fa-tags" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://ivanhan0511.github.io/archives" title="Archives">
    
      <i class="sidebar-button-icon fas fa-lg fa-archive" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://ivanhan0511.github.io/#about" title="About">
    
      <i class="sidebar-button-icon fas fa-lg fa-question" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/ivanhan0511" target="_blank" rel="noopener" title="GitHub">
    
      <i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://stackoverflow.com/users/14423790/ivan-han" target="_blank" rel="noopener" title="Stack Overflow">
    
      <i class="sidebar-button-icon fab fa-lg fa-stack-overflow" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Stack Overflow</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://ivanhan0511.github.io/index.xml" title="RSS">
    
      <i class="sidebar-button-icon fas fa-lg fa-rss" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      
  <div class="post-header-cover
              text-center
              post-header-cover--full"
       style="background-image:url('/image-2.png')"
       data-behavior="4">
    
  </div>


      <div id="main" data-behavior="4"
        class="hasCover
               hasCoverMetaOut
               hasCoverCaption">
        <article class="post" id="top">
          
            <span class="post-header-cover-caption caption">A beautiful image</span>
          
          
            <div class="post-header main-content-wrap text-center">
  
    <h1 class="post-title">
      Spring
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2024-10-26T11:22:00&#43;08:00">
        
  
  
  
  
    October 26, 2024
  

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="https://ivanhan0511.github.io/categories/java">Java</a>, 
    
      <a class="category-link" href="https://ivanhan0511.github.io/categories/webframework">WebFramework</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <p>This is a custom summary and does <em>NOT</em> appear in the post.</p>
<h1 id="table-of-contents">Table of Contents</h1>
<nav id="TableOfContents">
  <ul>
    <li><a href="#i-environment">I. ENVIRONMENT</a>
      <ul>
        <li><a href="#a-rd-and-testing-env">A. R&amp;D and Testing Env</a>
          <ul>
            <li><a href="#1-backup-and-sync">1. Backup and Sync</a></li>
          </ul>
        </li>
        <li><a href="#b-product-env-and-fixing-bugs">B. Product Env and Fixing Bugs</a></li>
        <li><a href="#c-demo-env">C. Demo Env</a></li>
      </ul>
    </li>
    <li><a href="#ii-package-management">II. PACKAGE MANAGEMENT</a>
      <ul>
        <li><a href="#a-first-of-all">A. First of All</a></li>
        <li><a href="#b-how-to-use-maven">B. How to use maven</a></li>
      </ul>
    </li>
    <li><a href="#iii-jvm">III. JVM</a></li>
    <li><a href="#iv-ioc">IV. IOC</a>
      <ul>
        <li><a href="#a-lifecircle">A. LifeCircle</a></li>
      </ul>
    </li>
    <li><a href="#chapter-2">V. AOP</a>
      <ul>
        <li><a href="#a-http-è¯·æ±‚æ³¨è§£">A. HTTP è¯·æ±‚æ³¨è§£</a></li>
        <li><a href="#b-æ˜“æ··æ·†æ³¨è§£çš„å¯¹æ¯”">B. æ˜“æ··æ·†æ³¨è§£çš„å¯¹æ¯”</a></li>
        <li><a href="#c-transactional">C. @Transactional</a></li>
      </ul>
    </li>
    <li><a href="#vi-servlet">VI. SERVLET</a></li>
    <li><a href="#vii-security">VII. SECURITY</a></li>
    <li><a href="#viii-job">VIII. JOB</a></li>
    <li><a href="#ix-third-part-http-api">IX. THIRD-PART HTTP API</a></li>
    <li><a href="#x-event-monitor">X. EVENT MONITOR</a></li>
    <li><a href="#xi-dao-mapper">XI. DAO MAPPER</a>
      <ul>
        <li><a href="#a-transactional">A. Transactional</a>
          <ul>
            <li><a href="#1-propagation">1. Propagation</a></li>
            <li><a href="#20-isolation">2.0 Isolation</a></li>
            <li><a href="#21-isolationç”Ÿå‘½å‘¨æœŸ">2.1 Isolationç”Ÿå‘½å‘¨æœŸ</a></li>
            <li><a href="#22-é˜…è¯»åˆ—è¡¨æ–‡ç« ">2.2 é˜…è¯»åˆ—è¡¨æ–‡ç« </a></li>
          </ul>
        </li>
        <li><a href="#b-jdbc">B. JDBC</a>
          <ul>
            <li><a href="#1-jdbcäº‹åŠ¡çš„æ§åˆ¶æµç¨‹">1. JDBCäº‹åŠ¡çš„æ§åˆ¶æµç¨‹</a></li>
            <li><a href="#2-å­¦ä¹ åˆ—è¡¨">2. å­¦ä¹ åˆ—è¡¨</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#xii-utils">XII. UTILS</a>
      <ul>
        <li><a href="#åˆ¤æ–­ç±»å®ä¾‹ä¸­çš„å„ä¸ªå±æ€§æ˜¯å¦æœ‰null">åˆ¤æ–­ç±»å®ä¾‹ä¸­çš„å„ä¸ªå±æ€§æ˜¯å¦æœ‰null</a></li>
        <li><a href="#å…¼å®¹å¤šç§æ—¶é—´æ ¼å¼çš„è¾“å…¥">å…¼å®¹å¤šç§æ—¶é—´æ ¼å¼çš„è¾“å…¥</a></li>
      </ul>
    </li>
    <li><a href="#xiii-miscellaneous">XIII. MISCELLANEOUS</a></li>
  </ul>
</nav>

<p>ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Š, å¤šçœ‹çœ‹<a href="https://www.liaoxuefeng.com/wiki/1539348902182944">å»–é›ªå³°æ‰‹å†™Sping</a>ä»¥ä¾¿äº†è§£Springçš„æ ¸å¿ƒé€»è¾‘æ€æƒ³</p>
<p>è‡ªå·±åªè®°å½•ä¸€äº›è‡ªå·±è§‰å¾—æœ‰ç”¨çš„å°Tip</p>
<h2 id="i-environment">I. ENVIRONMENT</h2>
<hr>
<h3 id="a-rd-and-testing-env">A. R&amp;D and Testing Env</h3>
<p>Use IDE of &ldquo;InteliJ IDEA&rdquo;, and <strong>download JDK wihin IDEA</strong></p>
<h4 id="1-backup-and-sync">1. Backup and Sync</h4>
<p>åŒæ­¥ä¹‹å, å¤§éƒ¨åˆ†çš„é…ç½®å’Œæ’ä»¶éƒ½å¯ä»¥åŒæ­¥ä¸‹æ¥, ä»¥ä¸‹ä»…ä½œå¤‡è€ƒ</p>
<p><strong>Configuration</strong></p>
<ul>
<li>Enable Backup and Sync -&gt; <code>Enable Backup and Sync</code></li>
<li><strong>åœ¨å„ä¸ªé¡¹ç›®ä¸­åˆ†åˆ«é€‰æ‹©Java JDKç¯å¢ƒ, ä¸å®‰è£…Javaåœ¨è£¸æœº</strong></li>
<li>Settsings -&gt; Editor -&gt; Code Style
<ul>
<li>General tab, é€‰æ‹© Line separator: Unix and macOS(\n)</li>
<li>SQL -&gt; General, å°†<code>keywords</code> å’Œ <code>Built-in types</code>è®¾ç½®ä¸ºå¤§å†™(To upper)</li>
</ul>
</li>
</ul>
<p><strong>Plugins</strong></p>
<ul>
<li>IdeaVim
<ul>
<li>åœ¨IDEAä¸­åˆ›å»º<code>~/.ideavimrc</code>æ–‡ä»¶(å®é™…åˆ›å»ºåœ¨<code>C:\Users\Ivan\.ideavimrc</code>)</li>
<li>åªéœ€åœ¨æœ€åä¸€è¡Œå¢åŠ é…ç½®å¼•ç”¨å³å¯<code>source //wsl.localhost/Ubuntu/root/.vimrc</code>, å·²ç»å¯ä»¥ä½¿ç”¨WSLä¸­çš„é…ç½®æ–‡ä»¶äº†</li>
<li>é…ç½®å®Œ, éœ€è¦é€€å‡ºå¹¶é‡æ–°æ‰“å¼€IDEA</li>
<li>IDEAçš„vimæ’ä»¶, ä»æ’å…¥æ¨¡å¼é€€å‡ºåˆ°æ™®é€šæ¨¡å¼å, è‡ªåŠ¨åˆ‡æ¢ä¸ºè‹±æ–‡è¾“å…¥æ³•, æš‚æ—¶æ²¡æå®š, Windows VisualStudioçš„VsVimæ’ä»¶å€’æ˜¯è‡ªåŠ¨æœ‰è¿™ä¸ªé…ç½®, æš‚æ—¶æ²¡ç¢ç£¨æ˜ç™½</li>
</ul>
</li>
<li><del>MyBatisCodeHelperPro(è²Œä¼¼æœ‰å®˜æ–¹ç‰ˆ, ä¸‹æ¬¡è¯•è¯•)</del></li>
<li>Redis</li>
<li>RemoteHost <code>java -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005 -jar pear-admin-pro-1.11.9-SNAPSHOT.jar</code></li>
</ul>
<p><strong>Additionally</strong>, record more Java in MicroSoft Windows 10/11 as below:</p>
<ul>
<li>åœ¨ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­å¢åŠ ä¸€æ¡, ä»¥é˜²æ­¢åœ¨ä¸åŒç¯å¢ƒä¸‹çš„å‘½ä»¤è¡Œè¾“å…¥ä¹±ç 
<ul>
<li>å˜é‡åç§°: <code>JAVA_TOOL_OPTIONS</code></li>
<li>å€¼: <code>-Duser.language=en</code></li>
</ul>
</li>
</ul>
<h3 id="b-product-env-and-fixing-bugs">B. Product Env and Fixing Bugs</h3>
<p>Install the <code>jdk-21_windows-x64_bin.exe</code> on MicroSoft Windows, or <code>apt install openjdk-21-jdk</code> on Ubuntu Service</p>
<p>And make sure the right <code>$PATH</code> on any kind of system</p>
<p>ä½¿ç”¨å…¬å¸çš„å¼€å‘æœåŠ¡å™¨ä½œä¸ºéƒ¨ç½²æœåŠ¡å™¨, ä¸å®¢æˆ·ç”Ÿäº§ç¯å¢ƒä¿æŒä¸€æ ·çš„æ•°æ®åº“ç»“æ„å’Œä»£ç æ‰“åŒ…</p>
<p>å¦‚æœé‡åˆ°ç”Ÿäº§ç¯å¢ƒçš„é—®é¢˜, ä½¿ç”¨è¯¥ç¯å¢ƒç”¨äºéªŒè¯, å¤‡ä»½å’Œä¿®å¤</p>
<h3 id="c-demo-env">C. Demo Env</h3>
<p>Install the <code>jdk-21_windows-x64_bin.exe</code> on MicroSoft Windows, or <code>apt install openjdk-21-jdk</code> on Ubuntu Service</p>
<p>And make sure the right <code>$PATH</code> on any kind of system</p>
<p>éƒ¨ç½²åœ¨äº‘ä¸Š, ä½¿ç”¨åŸŸå, ä»…ä½œå¯¹å¤–æ¼”ç¤º, ä½¿ç”¨å½“å‰çš„ç”Ÿäº§ç‰ˆæœ¬</p>
<h2 id="ii-package-management">II. PACKAGE MANAGEMENT</h2>
<hr>
<h3 id="a-first-of-all">A. First of All</h3>
<p>Maven 3.8.1 blocked http connection</p>
<ul>
<li>
<p>Do <span class="highlight-text red">NOT</span> edit this original IDEA maven settings file
<code>C:\Program Files\JetBrains\IntelliJ IDEA 2022.2.1\plugins\maven\lib\maven3\conf\settings.xml</code>

  
    
  
  
    
  
  
  


<figure class="highlight xml language-xml">
  <figcaption>
    
      <span>settings.xml</span>
    
  </figcaption>
  <table>
    <tbody>
      <tr>
        <td class="gutter">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre>
        </td>
        <td class="code">
          <pre class="code-highlight language-xml xml"><code class="xml">  ...
  &lt;mirrors&gt;
    &lt;!-- mirror
     | Specifies a repository mirror site to use instead of a given repository. The repository that
     | this mirror serves has an ID that matches the mirrorOf element of this mirror. IDs are used
     | for inheritance and direct lookup purposes, and must be unique across the set of mirrors.
     |
    &lt;mirror&gt;
      &lt;id&gt;mirrorId&lt;/id&gt;
      &lt;mirrorOf&gt;repositoryId&lt;/mirrorOf&gt;
      &lt;name&gt;Human Readable Name for this Mirror.&lt;/name&gt;
      &lt;url&gt;http://my.repository.com/repo/path&lt;/url&gt;
    &lt;/mirror&gt;
     --&gt;
    &lt;mirror&gt;
      &lt;id&gt;maven-default-http-blocker&lt;/id&gt;
      &lt;mirrorOf&gt;external:http:*&lt;/mirrorOf&gt;
      &lt;name&gt;Pseudo repository to mirror external repositories initially using HTTP.&lt;/name&gt;
      &lt;url&gt;http://0.0.0.0/&lt;/url&gt;
      &lt;blocked&gt;true&lt;/blocked&gt;
    &lt;/mirror&gt;
  &lt;/mirrors&gt;
  ...
  </code></pre>
        </td>
      </tr>
    </tbody>
  </table>
</figure>
</p>
</li>
<li>
<p>Find personal maven setting path in IDEA settings and DIY it <code>C:\Users\ivan\.m2\settings.xml</code> (If not exists, create this file)</p>

  
    
  
  
    
  
  
  


<figure class="highlight xml language-xml">
  <figcaption>
    
      <span>settings.xml</span>
    
  </figcaption>
  <table>
    <tbody>
      <tr>
        <td class="gutter">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre>
        </td>
        <td class="code">
          <pre class="code-highlight language-xml xml"><code class="xml">&lt;settings xmlns=&#34;http://maven.apache.org/SETTINGS/1.2.0&#34;
      xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
      xsi:schemaLocation=&#34;http://maven.apache.org/SETTINGS/1.2.0 http://maven.apache.org/xsd/settings-1.2.0.xsd&#34;&gt;
  &lt;mirrors&gt;
    &lt;!-- mirror
     | Specifies a repository mirror site to use instead of a given repository. The repository that
     | this mirror serves has an ID that matches the mirrorOf element of this mirror. IDs are used
     | for inheritance and direct lookup purposes, and must be unique across the set of mirrors.
     |
    &lt;mirror&gt;
      &lt;id&gt;mirrorId&lt;/id&gt;
      &lt;mirrorOf&gt;repositoryId&lt;/mirrorOf&gt;
      &lt;name&gt;Human Readable Name for this Mirror.&lt;/name&gt;
      &lt;url&gt;http://my.repository.com/repo/path&lt;/url&gt;
    &lt;/mirror&gt;
    --&gt;
    &lt;mirror&gt;
      &lt;id&gt;aliyunmaven&lt;/id&gt;
      &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;
      &lt;name&gt;é˜¿é‡Œäº‘å…¬å…±ä»“åº“&lt;/name&gt;
      &lt;url&gt;https://maven.aliyun.com/repository/public&lt;/url&gt;
    &lt;/mirror&gt;
  &lt;/mirrors&gt;
&lt;/settings&gt;
  </code></pre>
        </td>
      </tr>
    </tbody>
  </table>
</figure>

</li>
<li>
<p>Reload pom.xml file in IDEA and automaticlly download the dependencies</p>
</li>
</ul>
<h3 id="b-how-to-use-maven">B. How to use maven</h3>
<h2 id="iii-jvm">III. JVM</h2>
<hr>
<p>TODO: Some basic JVM knowledge</p>
<h2 id="iv-ioc">IV. IOC</h2>
<hr>
<h3 id="a-lifecircle">A. LifeCircle</h3>
<p>@Configuration</p>
<p><a href="https://www.cnblogs.com/java-chen-hao/p/11640177.html">https://www.cnblogs.com/java-chen-hao/p/11640177.html</a></p>
<h2 id="chapter-2">V. AOP</h2>
<hr>
<p>JetBrains IDEA ä¸­å¦‚æœæƒ³äº†è§£æŸä¸ªæ³¨è§£çš„å®ç°, æ²¡æœ‰å¤ªå¥½çš„åŠæ³•, å°±åƒæƒ³æŸ¥æ‰¾ä¸€ä¸ªç±»åœ¨å“ªé‡Œè¢«åå°„å¹¶è°ƒç”¨äº†, è¯•è¡Œçš„åŠæ³•:</p>
<ul>
<li>é˜…è¯»å¤§å‚çš„æºç , æ–‡æ¡£, äº†è§£è¯¥æ³¨è§£çš„å†…éƒ¨å®ç°é€»è¾‘</li>
<li>å°å‚çš„ä»£ç , åªèƒ½æ˜¯å…¨æ–‡æŸ¥æ‰¾ç±»ä¼¼è¿™æ ·çš„<code>getAnnotation(DictFormat.class)</code>ä»£ç </li>
</ul>
<h3 id="a-http-è¯·æ±‚æ³¨è§£">A. HTTP è¯·æ±‚æ³¨è§£</h3>
<ul>
<li>[TODO]: å„ç§ç»§æ‰¿å…³ç³»çš„æ³¨è§£, ç±»ä¼¼RestController, åŒ…å«äº†ResponseBodyç­‰, åç»­è¡¥å……</li>
<li>Controllerä¸­è®¾ç½®Headers, æŒ‡å®šContent-Type/Accept
<ul>
<li>Springbootä¸­Controllerä¸­çš„comsumesæ‰€æŒ‡å®šçš„æ˜¯HTTPå®¢æˆ·ç«¯çš„Content-Typeçš„å†…å®¹, é»˜è®¤application/x-www-form-urlencoded</li>
<li>Springbootä¸­Controllerä¸­çš„producesæ‰€æŒ‡å®šçš„æ˜¯HTTPå®¢æˆ·ç«¯çš„Acceptçš„å†…å®¹</li>
</ul>
</li>
</ul>
<blockquote>
  <p>
å¸¸è§çš„httpå¤´éƒ¨Content-Type:<br>
- application/x-www-form-urlencoded<br>
- multipart/form-data<br>
- application/json<br>
- application/xml<br>
<br>
å‰åç»„åˆå¦‚ä¸‹:<br>
- æœåŠ¡ç«¯è®¾ç½®`Content-Type:"application/json"`å¹¶è¿”å›ç»™å‰ç«¯, å‰ç«¯dataTypeæŒ‡å®š"json"<br>
  å¯ä»¥è§£ç HTTPçš„bodyå†…å®¹<br>
- æœåŠ¡ç«¯è®¾ç½®`Content-Type:application/json`å¹¶è¿”å›ç»™å‰ç«¯, å‰ç«¯dataTypeä¸æŒ‡å®š"json"<br>
  å¯ä»¥è§£ç HTTPçš„bodyå†…å®¹, dataç±»å‹æ˜¯Object<br>
- æœåŠ¡ç«¯ä¸è®¾ç½®`Content-Type:application/jsonResponse`å¹¶è¿”å›ç»™å‰ç«¯, å‰ç«¯dataTypeæŒ‡å®š"json"<br>
  å¯ä»¥è§£ç HTTPçš„bodyå†…å®¹, dataç±»å‹æ˜¯Object<br>
- æœåŠ¡ç«¯ä¸è®¾ç½®`Content-Type:application/json`å¹¶è¿”å›ç»™å‰ç«¯, å‰ç«¯dataTypeä¸æŒ‡å®š"json"<br>
  ä¸èƒ½è§£ç HTTPçš„bodyå†…å®¹, dataç±»å‹æ˜¯String<br>
</p>
  <footer>
    <strong>HTTPå›é¡¾</strong>
    
      
        <cite>æ¥è‡ªäºç½‘ç»œ</cite>
      
    
  </footer>
</blockquote>
<h3 id="b-æ˜“æ··æ·†æ³¨è§£çš„å¯¹æ¯”">B. æ˜“æ··æ·†æ³¨è§£çš„å¯¹æ¯”</h3>
<p>@Component @Bean @Service @Configurable, With this annotation, a class can be scaned manually or automaticlly</p>
<p><code>@Bean</code>,</p>
<p><code>@Component</code>ä¸<code>@Service</code>æ²¡æœ‰åŒºåˆ«, <code>@Service</code>è¿˜æ²¡æƒ³å¥½, æ˜¯ä¸€ä¸ªé¢„ç•™çš„æ³¨è§£å®šä¹‰</p>
<p><code>@Configurable</code>æ˜¯å•ä¾‹æ¨¡å¼, åœ¨å¯åŠ¨æ—¶åŠ è½½</p>
<p><strong>@Resource @Autowired</strong></p>
<blockquote>
  <p>
Both @Autowired (or @Inject) and @Resource work equally well. But there is a conceptual difference or a difference in the meaning<br/><br/>
@Resource means get me a known resource by name. The name is extracted from the name of the annotated setter or field, or it is taken from the name-Parameter.<br/><br/>
@Inject or @Autowired try to wire in a suitable other component by type.<br/><br/>
So, basically these are two quite distinct concepts. Unfortunately the Spring-Implementation of @Resource has a built-in fallback, which kicks in when resolution by-name fails. In this case, it falls back to the @Autowired-kind resolution by-type.<br/>
While this fallback is convenient, IMHO it causes a lot of confusion, because people are unaware of the conceptual difference and tend to use @Resource for type-based autowiring.

</p>
  <footer>
    <strong>stackoverflow</strong>
    
      <cite><a href="https://stackoverflow.com/questions/4093504/resource-vs-autowired" target="_blank" rel="external">@Resource vs @Autowired</a></cite>
    
  </footer>
</blockquote>
<p><strong>@Repository @Mapper</strong></p>
<ul>
<li>@Mapper ä¸€å®šè¦æœ‰ï¼Œå¦åˆ™ Mybatis æ‰¾ä¸åˆ° mapperã€‚</li>
<li>@Repository å¯æœ‰å¯æ— ï¼Œå¯ä»¥æ¶ˆå»ä¾èµ–æ³¨å…¥çš„æŠ¥é”™ä¿¡æ¯ã€‚</li>
<li>@MapperScan å¯ä»¥æ›¿ä»£ @Mapperã€‚</li>
</ul>
<p><strong>@Validate @Valid</strong></p>
<ul>
<li>@Validateæ˜¯org.springframework.validation.annotation.Validated å¯¼å…¥çš„</li>
<li>@Validate å¯ä»¥åˆ†ç»„</li>
<li>@Validæ˜¯javax.validation.Valid å¯¼å…¥çš„</li>
<li>@Valid å¯ä»¥é€’å½’</li>
<li>controllerç±»ä¸Šå†™: @Validated
<ul>
<li>å¦‚æœæ˜¯Beançš„å¯¹è±¡xxxRequestç±»é™åˆ¶å‚æ•°, åˆ™å‚æ•°ç±»ä¸­å„è‡ªæ ¡éªŒ; åœ¨controllerç±»ä¸­çš„æ–¹æ³•å‚æ•°æ‹¬å·å†…å†™: @Valid</li>
<li>å¦‚æœæ˜¯å±æ€§String numberé™åˆ¶, åœ¨controllerç±»ä¸­çš„æ–¹æ³•å…¥å‚å‰å†™: @NotBlank(message = &ldquo;xxxä¸èƒ½ä¸ºç©º&rdquo;)</li>
</ul>
</li>
</ul>
<p>PS:</p>
<p>@RequestParam()ä¸é‚£ä¹ˆå¥½ç”¨, è¿”å›ä¿¡æ¯ä¸å‹å¥½</p>
<h3 id="c-transactional">C. @Transactional</h3>
<p>è¯¦è§ DAO Mapperç« èŠ‚</p>
<h2 id="vi-servlet">VI. SERVLET</h2>
<hr>
<h2 id="vii-security">VII. SECURITY</h2>
<hr>
<p>ä»¥ä¸‹å¤§æ¦‚æè¿°çš„æ˜¯Java Securityçš„ä¸»è¦ç»„ä»¶ç»“æ„, å³ä½¿é—å¿˜äº†å®ç°ç»†èŠ‚, æŒæ¡å…¶ç»“æ„å’Œæœºåˆ¶, å°±å®¹æ˜“ç†è§£å¾—å¤š</p>
<p><strong>Configure</strong>
è¿™é‡ŒåŒ…å«åˆå§‹åŒ–, æ³¨å†Œå“ªäº›filter</p>
<p><strong>Filter</strong>
å…·ä½“æ‹¦æˆª, å¹¶æŠŠç›¸å¯¹åº”çš„ä¸”support()çš„providerä¼ è¿›å»</p>
<p><strong>Provider</strong>
æä¾›è‡ªå·±çš„è®¤è¯æ¯”å¯¹å®ç°æ–¹æ³•, å¹¶ä¸”å®ç°<code>support()</code>æ»¡è¶³filteræŸ¥æ‰¾</p>
<p><strong>Handler</strong>
å¢åŠ æˆåŠŸä¸å¤±è´¥çš„handler</p>
<h2 id="viii-job">VIII. JOB</h2>
<hr>
<p>Quartz</p>
<h2 id="ix-third-part-http-api">IX. THIRD-PART HTTP API</h2>
<hr>
<p>RestTemplate æ˜¯ä»Spring3.0å¼€å§‹æ”¯æŒçš„ä¸€ä¸ªè¿œç¨‹HTTPè¯·æ±‚å·¥å…·ï¼ŒRestTemplateæä¾›äº†å¸¸è§çš„RestæœåŠ¡(Resté£æ ¼ã€Restæ¶æ„)çš„å®¢æˆ·ç«¯è¯·æ±‚çš„æ¨¡ç‰ˆï¼Œèƒ½å¤Ÿå¤§å¤§æé«˜å®¢æˆ·ç«¯çš„ç¼–å†™æ•ˆç‡</p>
<p>å¤šå¹´æ¥ï¼ŒSpringæ¡†æ¶çš„RestTemplateä¸€ç›´æ˜¯å®¢æˆ·ç«¯HTTPè®¿é—®çš„é¦–é€‰è§£å†³æ–¹æ¡ˆï¼Œå®ƒæä¾›äº†åŒæ­¥ã€é˜»å¡APIä»¥ç®€æ´çš„æ–¹å¼å¤„ç†HTTPè¯·æ±‚ã€‚ç„¶è€Œï¼Œéšç€å¯¹éé˜»å¡ã€ååº”å¼ç¼–ç¨‹ä»¥æ›´å°‘çš„èµ„æºå¤„ç†å¹¶å‘çš„éœ€æ±‚ä¸æ–­å¢åŠ ï¼Œç‰¹åˆ«æ˜¯åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼ŒRestTemplateå·²ç»æ˜¾éœ²å‡ºå…¶å±€é™æ€§ã€‚
ä»Spring Framework 5å¼€å§‹ï¼ŒRestTemplateå·²è¢«æ ‡è®°ä¸ºå·²å¼ƒç”¨ï¼ŒSpringå›¢é˜Ÿæ¨èWebClientä½œä¸ºå…¶ç»§ä»»è€…ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡å®é™…ç¤ºä¾‹æ·±å…¥æ¢è®¨RestTemplateè¢«å¼ƒç”¨çš„åŸå› ã€é‡‡ç”¨WebClientçš„ä¼˜åŠ¿ä»¥åŠå¦‚ä½•æœ‰æ•ˆè¿‡æ¸¡ã€‚</p>
<blockquote>
  <p>
Synchronous client to perform HTTP requests, exposing a simple, template method API over underlying HTTP client libraries such as the JDK HttpURLConnection.
<br>
NOTE: As of 6.1, RestClient offers a more modern API for synchronous HTTP access. For asynchronous and streaming scenarios, consider the reactive org. springframework. web. reactive. function. client. WebClient.
</p>
  <footer>
    <strong></strong>
    
      
        <cite></cite>
      
    
  </footer>
</blockquote>
<p>ä¼ ç»Ÿåº”ç”¨: æ–°çš„RestClient</p>
<p>æµå¼åº”ç”¨: æ‰è€ƒè™‘WebClient</p>
<h2 id="x-event-monitor">X. EVENT MONITOR</h2>
<hr>
<p>ApplicationEvent Monitor
module-bpmæ¨¡å—ä¸­æœ‰ç”¨åˆ°, æ‹¿æ¥ä¸»ä¹‰, ä¸Šæ¸¸å…¥åº“å&quot;ç”Ÿäº§&quot;å‡ºä¸‹æ¸¸åº“å­˜å°±ä¾é è¿™ä¸ªç›‘å¬è€…è§‚å¯Ÿå®¢æˆ·å®šåˆ¶çš„BOMåŸæ–™æ˜¯å¦æ»¡è¶³, æ»¡è¶³å³å¯ç”Ÿäº§
[TODO]:</p>
<h2 id="xi-dao-mapper">XI. DAO MAPPER</h2>
<hr>
<p>æŠŠäº‹åŠ¡ä¼ æ’­æ”¾åœ¨è¿™é‡Œ, ä¸»è¦æ˜¯å€Ÿé‰´äº†<a href="https://chatgpt.com/c/67f53a1e-c224-8006-8be6-47110ff83864">ChatGPTçš„è§£ç­”</a></p>
<table>
<thead>
<tr>
<th>å±‚çº§</th>
<th>æŠ€æœ¯/æ¦‚å¿µ</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>åº”ç”¨å±‚</strong></td>
<td><code>@Transactional</code></td>
<td>Spring æä¾›çš„æ³¨è§£å¼äº‹åŠ¡ç®¡ç†ï¼Œå£°æ˜å¼å°è£…</td>
</tr>
<tr>
<td><strong>æ¡†æ¶å±‚</strong></td>
<td>Spring Txï¼ˆäº‹åŠ¡ç®¡ç†å™¨ï¼‰</td>
<td>ç®¡ç†äº‹åŠ¡çš„å¼€å§‹ã€æäº¤ã€å›æ»šç­‰æµç¨‹</td>
</tr>
<tr>
<td><strong>æ•°æ®è®¿é—®å±‚</strong></td>
<td>JDBC / JPA / MyBatis</td>
<td>å®é™…æ‰§è¡Œ SQL çš„å·¥å…·ï¼ŒSpring Tx ä¼šå’Œå®ƒä»¬åä½œ</td>
</tr>
<tr>
<td><strong>é©±åŠ¨å±‚</strong></td>
<td>JDBC Driver</td>
<td>å…·ä½“æ•°æ®åº“å‚å•†å®ç°çš„äº‹åŠ¡æ¥å£</td>
</tr>
<tr>
<td><strong>æ•°æ®åº“å±‚</strong></td>
<td>MySQL / Postgres ç­‰</td>
<td>æ•°æ®çœŸæ­£æ‰§è¡Œäº‹åŠ¡ï¼šBEGINã€COMMITã€ROLLBACK</td>
</tr>
</tbody>
</table>
<h3 id="a-transactional">A. Transactional</h3>
<p>@Transactional æ˜¯ Spring æä¾›çš„å£°æ˜å¼äº‹åŠ¡è¯­æ³•ç³–ï¼›</p>
<p>å®ƒçš„æœ¬è´¨è¡Œä¸ºæ˜¯åŸºäº JDBC çš„äº‹åŠ¡æ§åˆ¶ï¼ˆæˆ–è€… JPA çš„ EntityManagerï¼Œä½†åº•å±‚è¿˜æ˜¯ JDBCï¼‰ï¼›</p>
<p>å®ƒä¸å±äºâ€œçº¯ç²¹çš„ JDBC API çŸ¥è¯†â€ï¼Œä½†å¿…é¡»ç†è§£ JDBC äº‹åŠ¡æœºåˆ¶ï¼Œä½ æ‰èƒ½çœŸæ­£ç†è§£å®ƒæ€ä¹ˆèµ·ä½œç”¨ã€‚</p>
<p><strong>Spring @Transactional çš„æ‰§è¡Œæµç¨‹å›¾</strong>
<blockquote>
  <p>
ä½ è°ƒç”¨æŸä¸ªæ ‡æ³¨ @Transactional çš„æ–¹æ³•
â†“
Spring AOP æ‹¦æˆªè¿™ä¸ªæ–¹æ³•è°ƒç”¨ï¼ˆé€šè¿‡ä»£ç†ï¼‰
â†“
è¿›å…¥äº‹åŠ¡æ‹¦æˆªå™¨ TransactionInterceptor
â†“
  â”œâ”€ åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦å·²æœ‰äº‹åŠ¡
  â”‚    â”œâ”€ å¦‚æœå·²æœ‰äº‹åŠ¡ï¼Œåˆ™æ ¹æ®ä¼ æ’­è¡Œä¸ºå†³å®šæ˜¯å¦å¤ç”¨/æ–°å»º
  â”‚    â””â”€ å¦‚æœæ²¡æœ‰äº‹åŠ¡ï¼Œå¼€å§‹æ–°äº‹åŠ¡ï¼š
  â”‚         â””â”€ DataSource è·å–è¿æ¥ï¼ŒsetAutoCommit(false)
â†“
æ‰§è¡Œä½ çš„ä¸šåŠ¡æ–¹æ³•
  â”œâ”€ æ–¹æ³•æ­£å¸¸è¿”å›ï¼šæäº¤äº‹åŠ¡ï¼ˆconn.commitï¼‰
  â””â”€ æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼šæ ¹æ®è§„åˆ™å†³å®šæ˜¯å¦ rollback
â†“
é‡Šæ”¾è¿æ¥ï¼ˆäº¤è¿˜ç»™è¿æ¥æ± ï¼‰
â†“
è¿”å›æ§åˆ¶æƒç»™ä½ 
</p>
  <footer>
    <strong>flow</strong>
    
      
        <cite></cite>
      
    
  </footer>
</blockquote></p>
<ol start="0">
<li>
<p>å›¾è§£ Spring @Transactional æ–¹æ³•æ‰§è¡Œçš„æºç æ ˆæµç¨‹, ä»ä¸šåŠ¡ä»£ç å‡ºå‘ï¼š

  
    
  
  
    
  
  
  


<figure class="highlight java language-java">
  <figcaption>
    
      <span>call</span>
    
  </figcaption>
  <table>
    <tbody>
      <tr>
        <td class="gutter">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
        </td>
        <td class="code">
          <pre class="code-highlight language-java java"><code class="java">@Service
public class UserService {

    @Transactional
    public void createUser() {
        // ä¿å­˜ç”¨æˆ·
        userRepository.save(...);
    }
}</code></pre>
        </td>
      </tr>
    </tbody>
  </table>
</figure>
</p>
</li>
<li>
<p>ä½ è°ƒç”¨ userService.createUser()ï¼Œå…¶å®æ˜¯ä»£ç†å¯¹è±¡åœ¨æ‰§è¡Œï¼š

  
    
  
  
    
  
  
  


<figure class="highlight java language-java">
  <figcaption>
    
      <span>invoke</span>
    
  </figcaption>
  <table>
    <tbody>
      <tr>
        <td class="gutter">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
        </td>
        <td class="code">
          <pre class="code-highlight language-java java"><code class="java">// åŸå§‹è°ƒç”¨
userService.createUser();

// å®é™…æ˜¯ Spring ç”Ÿæˆçš„ä»£ç†å¯¹è±¡æ‰§è¡Œï¼š
proxy.invoke(createUser)</code></pre>
        </td>
      </tr>
    </tbody>
  </table>
</figure>
</p>
</li>
<li>
<p>ä»£ç†å¯¹è±¡å†…éƒ¨æ‰§è¡Œï¼šTransactionInterceptor.invoke(&hellip;)

  
    
  
  
    
  
  
  


<figure class="highlight java language-java">
  <figcaption>
    
      <span>proxy</span>
    
  </figcaption>
  <table>
    <tbody>
      <tr>
        <td class="gutter">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre>
        </td>
        <td class="code">
          <pre class="code-highlight language-java java"><code class="java">public Object invoke(MethodInvocation invocation) throws Throwable {
    // è·å–äº‹åŠ¡å±æ€§ï¼ˆæ¥è‡ª @Transactionalï¼‰
    TransactionAttribute txAttr = getTransactionAttributeSource().getTransactionAttribute(...);

    // è·å–äº‹åŠ¡ç®¡ç†å™¨ï¼ˆDataSourceTransactionManagerï¼‰
    PlatformTransactionManager tm = determineTransactionManager(...);

    // åˆ›å»ºäº‹åŠ¡ï¼ˆå¼€å¯ conn.setAutoCommit(false)ï¼‰
    TransactionStatus status = tm.getTransaction(txAttr);

    Object retVal;
    try {
        // è°ƒç”¨çœŸæ­£çš„æ–¹æ³•ä½“
        retVal = invocation.proceed();

        // æ²¡å¼‚å¸¸ -&gt; æäº¤äº‹åŠ¡
        tm.commit(status);
    } catch (Throwable ex) {
        // æœ‰å¼‚å¸¸ -&gt; å›æ»šäº‹åŠ¡
        tm.rollback(status);
        throw ex;
    }

    return retVal;
}</code></pre>
        </td>
      </tr>
    </tbody>
  </table>
</figure>
</p>
</li>
<li>
<p>æ•°æ®åº“è¿æ¥å¤„ç†ï¼ˆDataSourceTransactionManagerï¼‰

  
    
  
  
    
  
  
  


<figure class="highlight java language-java">
  <figcaption>
    
      <span>jdbc</span>
    
  </figcaption>
  <table>
    <tbody>
      <tr>
        <td class="gutter">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
        </td>
        <td class="code">
          <pre class="code-highlight language-java java"><code class="java">public TransactionStatus getTransaction(...) {
    // ä»å½“å‰çº¿ç¨‹è·å– ConnectionHolderï¼Œå¦‚æœæ²¡æœ‰å°±æ–°å»ºè¿æ¥
    Connection con = dataSource.getConnection();

    // è®¾ç½® autoCommit ä¸º false
    con.setAutoCommit(false);

    // ç”¨ TransactionSynchronizationManager ç»‘å®šåˆ°å½“å‰çº¿ç¨‹
}</code></pre>
        </td>
      </tr>
    </tbody>
  </table>
</figure>
</p>
</li>
<li>
<p>æäº¤ or å›æ»šé˜¶æ®µ

  
    
  
  
    
  
  
  


<figure class="highlight java language-java">
  <figcaption>
    
      <span>commit</span>
    
  </figcaption>
  <table>
    <tbody>
      <tr>
        <td class="gutter">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
        </td>
        <td class="code">
          <pre class="code-highlight language-java java"><code class="java">// æ­£å¸¸æäº¤ï¼š
con.commit();

// å¼‚å¸¸å›æ»šï¼š
con.rollback();</code></pre>
        </td>
      </tr>
    </tbody>
  </table>
</figure>
</p>
</li>
<li>
<p>å°ç»“ï¼šå®Œæ•´è°ƒç”¨æ ˆè·¯å¾„
<blockquote>
  <p>
ä½ å†™çš„ createUser() æ–¹æ³•
   â†“
Spring AOP ä»£ç†å¯¹è±¡ï¼ˆJDK / CGLIBï¼‰
   â†“
TransactionInterceptor.invoke()
   â†“
DataSourceTransactionManager.getTransaction()
   â†“
ä¸šåŠ¡æ–¹æ³•æ‰§è¡Œ
   â†“
commit æˆ– rollback
</p>
  <footer>
    <strong></strong>
    
      
        <cite></cite>
      
    
  </footer>
</blockquote></p>
</li>
</ol>
<p>ğŸ’¬ å°æç¤º
ç¬¬ä¸€æ¬¡æ‰§è¡Œäº‹åŠ¡æ–¹æ³•æ—¶ï¼ŒSpring ä¼šåšå¤§é‡å‡†å¤‡å·¥ä½œï¼Œä½† ä¹‹åä¼šç¼“å­˜äº‹åŠ¡å±æ€§ï¼ˆå¦‚ä¼ æ’­è¡Œä¸ºã€å¼‚å¸¸å›æ»šè§„åˆ™ç­‰ï¼‰ï¼Œæ‰§è¡Œæ•ˆç‡æ˜¯å¾ˆé«˜çš„ã€‚</p>
<p>äº‹åŠ¡çŠ¶æ€ã€è¿æ¥ç­‰éƒ½å­˜åœ¨çº¿ç¨‹å±€éƒ¨å˜é‡ä¸­ï¼Œä¸€ä¸ªçº¿ç¨‹ä¸€ä¸ªäº‹åŠ¡ä¸Šä¸‹æ–‡ã€‚</p>
<p>ä½ ç”¨çš„ @Transactional å…¶å®æ˜¯è°ƒç”¨é“¾çš„â€œå¼€å…³â€ï¼Œåº•ä¸‹è·‘çš„æ˜¯ä¸€æ•´å¥— AOP + JDBC çš„ç»„åˆæœºåˆ¶ã€‚</p>
<h4 id="1-propagation">1. Propagation</h4>
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>åç§°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>âœ… <code>REQUIRED</code></td>
<td>æœ‰äº‹åŠ¡ç”¨å½“å‰ï¼Œæ²¡æœ‰å°±æ–°å»ºï¼ˆé»˜è®¤ï¼‰</td>
<td></td>
</tr>
<tr>
<td>âœ… <code>REQUIRES_NEW</code></td>
<td>å§‹ç»ˆæ–°å»ºäº‹åŠ¡ï¼ŒæŒ‚èµ·å¤–å±‚äº‹åŠ¡</td>
<td></td>
</tr>
<tr>
<td>âœ… <code>NESTED</code></td>
<td>å¦‚æœæœ‰äº‹åŠ¡ï¼Œå°±åµŒå¥—ä¸€ä¸ªâ€œä¿å­˜ç‚¹â€ï¼›å¦åˆ™æ–°å»º</td>
<td></td>
</tr>
<tr>
<td><code>SUPPORTS</code></td>
<td>æœ‰äº‹åŠ¡å°±å‚ä¸ï¼Œæ²¡æœ‰å°±éäº‹åŠ¡æ‰§è¡Œ</td>
<td></td>
</tr>
<tr>
<td><code>NOT_SUPPORTED</code></td>
<td>æ€»æ˜¯éäº‹åŠ¡æ‰§è¡Œï¼Œä¼šæŒ‚èµ·å·²æœ‰äº‹åŠ¡</td>
<td></td>
</tr>
<tr>
<td><code>MANDATORY</code></td>
<td>å¿…é¡»æœ‰äº‹åŠ¡ï¼Œæ²¡æœ‰å°±æŠ›å¼‚å¸¸</td>
<td></td>
</tr>
<tr>
<td><code>NEVER</code></td>
<td>å¿…é¡»æ— äº‹åŠ¡ï¼Œæœ‰äº‹åŠ¡å°±æŠ›å¼‚å¸¸</td>
<td></td>
</tr>
</tbody>
</table>
<p>âœ… ä¸€ã€REQUIREDï¼ˆé»˜è®¤ï¼‰

  
    
  
  
    
  
  
  


<figure class="highlight java language-java">
  <figcaption>
    
      <span>REQUIRED</span>
    
  </figcaption>
  <table>
    <tbody>
      <tr>
        <td class="gutter">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
        </td>
        <td class="code">
          <pre class="code-highlight language-java java"><code class="java">@Transactional(propagation = Propagation.REQUIRED)
public void methodA() {
    methodB(); // methodB ä¹Ÿæ˜¯ @Transactionalï¼ˆé»˜è®¤ï¼‰
}</code></pre>
        </td>
      </tr>
    </tbody>
  </table>
</figure>
</p>
<p>è¡Œä¸ºï¼šmethodB ä¼šå¤ç”¨ methodA çš„äº‹åŠ¡</p>
<p>ä¼˜ç‚¹ï¼šç®€å•ã€æ•ˆç‡é«˜</p>
<p>ç¼ºç‚¹ï¼šå¦‚æœ B æŠ›å¼‚å¸¸ï¼Œæ•´ä¸ª A éƒ½å›æ»šï¼Œå®¹æ˜“ä¼ æ’­å¤ªå¹¿</p>
<p>ğŸ” äºŒã€REQUIRES_NEWï¼ˆå¼ºåˆ¶æ–°äº‹åŠ¡ï¼‰

  
    
  
  
    
  
  
  


<figure class="highlight java language-java">
  <figcaption>
    
      <span>REQUIRED_NEW</span>
    
  </figcaption>
  <table>
    <tbody>
      <tr>
        <td class="gutter">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre>
        </td>
        <td class="code">
          <pre class="code-highlight language-java java"><code class="java">java
å¤åˆ¶
ç¼–è¾‘
@Transactional
public void outer() {
    saveMainData();
    try {
        saveLog(); // æ–°äº‹åŠ¡
    } catch (Exception e) {
        log.error(&#34;æ—¥å¿—ä¿å­˜å¤±è´¥&#34;);
    }
}

@Transactional(propagation = Propagation.REQUIRES_NEW)
public void saveLog() {
    ...
}</code></pre>
        </td>
      </tr>
    </tbody>
  </table>
</figure>
</p>
<p>è¡Œä¸ºï¼šæŒ‚èµ· outer() çš„äº‹åŠ¡ï¼Œè‡ªå·±åˆ›å»ºä¸€ä¸ªæ–°äº‹åŠ¡</p>
<p>é€‚åˆåœºæ™¯ï¼š</p>
<p>è®°å½•æ“ä½œæ—¥å¿—ã€å¼‚æ­¥ä¿å­˜ç­‰ï¼Œä¸å½±å“ä¸»æµç¨‹</p>
<p>å¸Œæœ›â€œéƒ¨åˆ†æäº¤â€çš„å­æ“ä½œï¼Œå³ä½¿ä¸»äº‹åŠ¡å¤±è´¥ä¹Ÿä¸å½±å“å®ƒ</p>
<p>ğŸªœ ä¸‰ã€NESTEDï¼ˆåµŒå¥—äº‹åŠ¡ï¼‰

  
    
  
  
    
  
  
  


<figure class="highlight java language-java">
  <figcaption>
    
      <span>NESTED</span>
    
  </figcaption>
  <table>
    <tbody>
      <tr>
        <td class="gutter">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre>
        </td>
        <td class="code">
          <pre class="code-highlight language-java java"><code class="java">@Transactional
public void parent() {
    save1(); // æ’å…¥æ•°æ®1
    try {
        save2(); // æŠ›å¼‚å¸¸
    } catch (Exception e) {
        ...
    }
    save3();
}

@Transactional(propagation = Propagation.NESTED)
public void save2() {
    ...
}</code></pre>
        </td>
      </tr>
    </tbody>
  </table>
</figure>
</p>
<p>è¡Œä¸ºï¼šå¦‚æœæœ‰äº‹åŠ¡ï¼Œå°±åˆ›å»ºä¸€ä¸ªâ€œä¿å­˜ç‚¹â€ï¼Œå¯ä»¥å±€éƒ¨å›æ»šè€Œä¸å½±å“å¤–å±‚ï¼›å¦‚æœæ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™ç­‰ä»·äº REQUIREDã€‚</p>
<p>åº•å±‚ä¾èµ– JDBC çš„ savepoint æ”¯æŒ</p>
<p><em>æ³¨æ„ï¼šä¸æ˜¯æ‰€æœ‰æ•°æ®åº“ + JDBC é©±åŠ¨éƒ½æ”¯æŒ NESTED</em></p>
<p>ğŸ‘€ å››ã€å®æˆ˜ä¸­å¸¸è§â€œå‘â€ä¸åœºæ™¯</p>
<p>âŒ 1. å†…éƒ¨æ–¹æ³•è°ƒç”¨äº‹åŠ¡å¤±æ•ˆ

  
    
  
  
    
  
  
  


<figure class="highlight java language-java">
  <figcaption>
    
      <span>trap</span>
    
  </figcaption>
  <table>
    <tbody>
      <tr>
        <td class="gutter">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
        </td>
        <td class="code">
          <pre class="code-highlight language-java java"><code class="java">@Transactional
public void outer() {
    this.inner(); // ä¸ä¼šç»è¿‡ä»£ç†ï¼Œäº‹åŠ¡æ³¨è§£å¤±æ•ˆï¼
}

@Transactional
public void inner() {
    ...
}</code></pre>
        </td>
      </tr>
    </tbody>
  </table>
</figure>
</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<p>ç”¨ AOP è‡ªè°ƒç”¨æ–¹æ¡ˆï¼šå°† inner() æ”¾åˆ°åˆ«çš„ bean ä¸­</p>
<p>æˆ–é€šè¿‡ ApplicationContext.getBean(&hellip;).inner() è°ƒç”¨</p>
<p>ğŸ”¥ 2. æƒ³è¦å†…å±‚äº‹åŠ¡å¤±è´¥ä½†ä¸»äº‹åŠ¡ç»§ç»­ï¼ˆREQUIRES_NEWï¼‰

  
    
  
  
    
  
  
  


<figure class="highlight java language-java">
  <figcaption>
    
      <span>solution</span>
    
  </figcaption>
  <table>
    <tbody>
      <tr>
        <td class="gutter">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
        </td>
        <td class="code">
          <pre class="code-highlight language-java java"><code class="java">@Transactional
public void mainProcess() {
    ...
    try {
        logService.writeLog(); // ä½¿ç”¨ REQUIRES_NEW
    } catch (Exception e) {
        log.warn(&#34;æ—¥å¿—å¤±è´¥ï¼Œä½†ä¸»æµç¨‹ç»§ç»­&#34;);
    }
}</code></pre>
        </td>
      </tr>
    </tbody>
  </table>
</figure>
</p>
<p>âš ï¸ 3. æƒ³å›æ»šå­æ“ä½œï¼Œä½†ä¸»äº‹åŠ¡ç»§ç»­ï¼ˆNESTEDï¼‰

  
    
  
  
  
  


<figure class="highlight  language-">
  <figcaption>
    
      <span>java</span>
    
  </figcaption>
  <table>
    <tbody>
      <tr>
        <td class="gutter">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
        </td>
        <td class="code">
          <pre class="code-highlight language- "><code class="">@Transactional
public void saveAll() {
    ...
    try {
        subSave(); // NESTED
    } catch (Exception e) {
        log.warn(&#34;å­ä¿å­˜å¤±è´¥ï¼Œä½†çˆ¶ç»§ç»­&#34;);
    }
}</code></pre>
        </td>
      </tr>
    </tbody>
  </table>
</figure>
</p>
<p>åªä¼š rollback åˆ°ä¿å­˜ç‚¹ï¼Œä¸ä¼šå½±å“å¤–å±‚äº‹åŠ¡ã€‚</p>
<p><strong>ğŸ›  æ€»ç»“ï¼šå¦‚ä½•é€‰æ‹©äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼Ÿ</strong></p>
<table>
<thead>
<tr>
<th>ç›®æ ‡</th>
<th>å»ºè®®ä½¿ç”¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨æˆåŠŸï¼Œè¦ä¹ˆå…¨å¤±è´¥</td>
<td>REQUIRED</td>
</tr>
<tr>
<td>ä¸»æ“ä½œæˆåŠŸä¸å¦ä¸å½±å“å­æ“ä½œæäº¤</td>
<td>REQUIRES_NEW</td>
</tr>
<tr>
<td>å­æ“ä½œå¤±è´¥åªæƒ³ rollback å­æ“ä½œï¼Œä¸å½±å“çˆ¶æµç¨‹</td>
<td>NESTED</td>
</tr>
<tr>
<td>å­æ“ä½œä¸æ˜¯æ ¸å¿ƒæµç¨‹ï¼Œå¯æ— äº‹åŠ¡æ‰§è¡Œ</td>
<td>NOT_SUPPORTED or SUPPORTS</td>
</tr>
</tbody>
</table>
<h4 id="20-isolation">2.0 Isolation</h4>
<p>ä»¥ä¸‹æ˜¯ MySQL äº‹åŠ¡éš”ç¦»çº§åˆ«çš„ç®€è¦åœºæ™¯åŠæ•ˆæœåŒºåˆ«ï¼š</p>
<ul>
<li>
<p>Read Uncommitted</p>
<p><strong>åœºæ™¯</strong>: å…è®¸è¯»å–æœªæäº¤çš„æ•°æ®ã€‚</p>
<p><strong>è„è¯»</strong>: å¯èƒ½å‘ç”Ÿï¼Œè¯»å–å…¶ä»–äº‹åŠ¡æœªæäº¤çš„æ•°æ®ã€‚</p>
<p><strong>ä¸å¯é‡å¤è¯»</strong>: å¯èƒ½å‘ç”Ÿï¼Œå› ä¸ºäº‹åŠ¡é—´å¯èƒ½ä¿®æ”¹å·²è¯»å–æ•°æ®ã€‚</p>
<p><strong>å¹»è¯»</strong>: å¯èƒ½å‘ç”Ÿï¼Œå› ä¸ºå¯èƒ½æ’å…¥æ–°æ•°æ®ã€‚</p>
</li>
<li>
<p>Read Committed</p>
<p><strong>åœºæ™¯</strong>: åªè¯»å–å·²æäº¤çš„æ•°æ®ï¼Œé¿å…è¯»å–æœªæäº¤äº‹åŠ¡çš„å†…å®¹ã€‚</p>
<p><strong>è„è¯»</strong>: ä¸ä¼šå‘ç”Ÿï¼Œä¿è¯è¯»å–çš„æ˜¯å·²æäº¤æ•°æ®ã€‚</p>
<p><strong>ä¸å¯é‡å¤è¯»</strong>: å¯èƒ½å‘ç”Ÿï¼Œå› ä¸ºåŒä¸€äº‹åŠ¡ä¸­é‡å¤è¯»å–æ—¶ï¼Œæ•°æ®å¯èƒ½è¢«å…¶ä»–äº‹åŠ¡ä¿®æ”¹ã€‚</p>
<p><strong>å¹»è¯»</strong>: å¯èƒ½å‘ç”Ÿï¼Œå› ä¸ºå…¶ä»–äº‹åŠ¡å¯èƒ½æ’å…¥æ–°è®°å½•ã€‚</p>
<p><strong>Tips</strong>: ä¸å¯é‡å¤è¯»é‡ç‚¹åœ¨äºupdateå’Œdelete</p>
</li>
<li>
<p>Repeatable Read (MySQLé»˜è®¤)</p>
<p><strong>åœºæ™¯</strong>: ä¿è¯åŒä¸€äº‹åŠ¡ä¸­ï¼Œè¯»å–çš„ç»“æœæ˜¯å›ºå®šçš„ï¼Œå³ä¾¿å…¶ä»–äº‹åŠ¡ä¿®æ”¹äº†æ•°æ®ã€‚</p>
<p><strong>è„è¯»</strong>: ä¸ä¼šå‘ç”Ÿã€‚</p>
<p><strong>ä¸å¯é‡å¤è¯»</strong>: ä¸ä¼šå‘ç”Ÿï¼Œäº‹åŠ¡ä¸­æ•°æ®ä¸€è‡´ã€‚</p>
<p><strong>å¹»è¯»</strong>: é€šè¿‡<strong>é—´éš™é”</strong>é¿å…ï¼ŒæŸ¥è¯¢èŒƒå›´å†…çš„æ•°æ®æ˜¯å›ºå®šçš„ã€‚</p>
<p><strong>Tips</strong>: è¯¥çº§åˆ«äº§ç”Ÿå¹»è¯»çš„é‡ç‚¹åœºæ™¯åœ¨äºinsert, æ€»çš„æ¥è¯´å°±æ˜¯äº‹åŠ¡Aå¯¹æ•°æ®è¿›è¡Œæ“ä½œï¼Œäº‹åŠ¡Bè¿˜æ˜¯å¯ä»¥ç”¨insertæ’å…¥æ•°æ®çš„ï¼Œå› ä¸ºä½¿ç”¨çš„æ˜¯è¡Œé”ï¼Œè¿™æ ·å¯¼è‡´çš„å„ç§å¥‡è‘©é—®é¢˜å°±æ˜¯å¹»è¯»ï¼Œè¡¨ç°å½¢å¼å¾ˆå¤š</p>
</li>
<li>
<p>Serializable</p>
<p><strong>åœºæ™¯</strong>: å¼ºåˆ¶äº‹åŠ¡ä¸²è¡ŒåŒ–ï¼Œç¡®ä¿äº‹åŠ¡é—´å®Œå…¨éš”ç¦»ã€‚</p>
<p><strong>è„è¯»</strong>: ä¸ä¼šå‘ç”Ÿã€‚</p>
<p><strong>ä¸å¯é‡å¤è¯»</strong>: ä¸ä¼šå‘ç”Ÿã€‚</p>
<p><strong>å¹»è¯»</strong>: ä¸ä¼šå‘ç”Ÿï¼Œå› ä¸ºä¼šå¯¹èŒƒå›´å†…çš„æ“ä½œåŠ é”ï¼Œé˜»æ­¢æ’å…¥æˆ–ä¿®æ”¹ã€‚</p>
</li>
<li>
<p>æ€»ç»“è¡¨æ ¼</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>Isolation Level</th>
<th>è„è¯»(Dirty Read)</th>
<th>ä¸å¯é‡å¤è¯»(Non Repeatable Read)</th>
<th>å¹»è¯»(Phantom Read)</th>
</tr>
</thead>
<tbody>
<tr>
<td>READ UNCOMMITTED</td>
<td>âœ… æœ‰</td>
<td>âœ… æœ‰</td>
<td>âœ… æœ‰</td>
</tr>
<tr>
<td>READ COMMITTED</td>
<td>âŒ æ— </td>
<td>âœ… æœ‰</td>
<td>âœ… æœ‰</td>
</tr>
<tr>
<td>REPEATABLE READ</td>
<td>âŒ æ— </td>
<td>âŒ æ— </td>
<td>âœ… æœ‰</td>
</tr>
<tr>
<td>SERIALIZABLE</td>
<td>âŒ æ— </td>
<td>âŒ æ— </td>
<td>âŒ æ— </td>
</tr>
</tbody>
</table>
<p>MySQL é»˜è®¤æ˜¯ REPEATABLE READï¼Œä½†åœ¨ Spring ä¸­é»˜è®¤æ˜¯ DEFAULTï¼Œè¡¨ç¤ºç”±æ•°æ®åº“å†³å®š
<blockquote>
  <p>
é€šå¸¸æƒ…å†µä¸‹ï¼Œselectè¯­å¥æ˜¯ä¸ä¼šå¯¹æ•°æ®åŠ é”ï¼Œå¦¨ç¢å½±å“å…¶ä»–çš„DMLå’ŒDDLæ“ä½œã€‚åŒæ—¶ï¼Œåœ¨å¤šç‰ˆæœ¬ä¸€è‡´è¯»æœºåˆ¶çš„æ”¯æŒä¸‹ï¼Œselectè¯­å¥ä¹Ÿä¸ä¼šè¢«å…¶ä»–ç±»å‹è¯­å¥æ‰€é˜»ç¢ã€‚
è€Œselec... for update è¯­å¥æ˜¯æˆ‘ä»¬ç»å¸¸ä½¿ç”¨æ‰‹å·¥åŠ é”è¯­å¥ã€‚åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œselect.for update,å¤§å®¶ä¼šå‘ç°ä¼šå¯¹æ•°æ®åº“ä¸­çš„è¡¨æˆ–æŸäº›è¡Œæ•°æ®è¿›è¡Œé”è¡¨ï¼Œåœ¨mysqlå››ä¸­ï¼Œå¦‚æœæŸ¥è¯¢æ¡ä»¶å¸¦æœ‰ä¸»é”®ï¼Œä¼šé”è¡Œæ•°æ®ï¼Œå¦‚æœæ²¡æœ‰ï¼Œä¼šé”è¡¨ã€‚
ç”±äºInnoDBé¢„è®¾æ˜¯Row-LevelLockï¼Œæ‰€ä»¥åªæœ‰ã€Œæ˜ç¡®ã€çš„æŒ‡å®šä¸»é”®ï¼ŒMySQLæ‰ä¼šæ‰§è¡ŒRow lock(åªé”ä½è¢«é€‰å–çš„èµ„æ–™ä¾‹)ï¼Œå¦åˆ™MySQLå°†ä¼šæ‰§è¡ŒTable Lock(å°†æ•´ä¸ªèµ„æ–™è¡¨å•ç»™é”ä½)ã€‚
</p>
  <footer>
    <strong></strong>
    
      
        <cite></cite>
      
    
  </footer>
</blockquote></p>
<h4 id="21-isolationç”Ÿå‘½å‘¨æœŸ">2.1 Isolationç”Ÿå‘½å‘¨æœŸ</h4>
<p>éš”ç¦»çº§åˆ«ä¸æ˜¯ä½ åœ¨ Java æ–¹æ³•ä¸­è®¾å®šäº†å°±é©¬ä¸Šç”Ÿæ•ˆã€‚å®ƒçš„ç”Ÿæ•ˆæ—¶æœºæ˜¯ï¼šåœ¨â€œå¼€å¯æ•°æ®åº“äº‹åŠ¡æ—¶â€</p>
<p>âœ… æ­£ç¡®åšæ³•ï¼ˆå¦‚ç¡®å®è¦å˜æ›´éš”ç¦»çº§åˆ«ï¼‰ï¼š

  
    
  
  
    
  
  
  


<figure class="highlight java language-java">
  <figcaption>
    
      <span>isolation</span>
    
  </figcaption>
  <table>
    <tbody>
      <tr>
        <td class="gutter">
          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
        </td>
        <td class="code">
          <pre class="code-highlight language-java java"><code class="java">@Transactional(propagation = Propagation.REQUIRES_NEW, isolation = Isolation.SERIALIZABLE)
public void innerMethod() { ... }</code></pre>
        </td>
      </tr>
    </tbody>
  </table>
</figure>

è¿™æ · Spring ä¼šæŒ‚èµ·å¤–éƒ¨äº‹åŠ¡ï¼Œå¼€å¯ä¸€ä¸ªæ–°äº‹åŠ¡ï¼Œæ‰ä¼šæŒ‰ä½ çš„ Isolation è®¾ç½®æ¥ç”Ÿæ•ˆï¼</p>
<h4 id="22-é˜…è¯»åˆ—è¡¨æ–‡ç« ">2.2 é˜…è¯»åˆ—è¡¨æ–‡ç« </h4>
<p><a href="https://www.cnblogs.com/zhengzhaoxiang/p/13972252.html">Mysql äº‹åŠ¡éš”ç¦»çº§åˆ«å’Œé”çš„å…³ç³»</a></p>
<blockquote>
<p>**é”é˜²æ­¢åˆ«çš„äº‹åŠ¡ä¿®æ”¹æˆ–åˆ é™¤ï¼ŒGAPé”é˜²æ­¢åˆ«çš„äº‹åŠ¡æ–°å¢ï¼Œ**è¡Œé”å’Œ GAPé”ç»“åˆå½¢æˆçš„çš„ Next-Keyé”å…±åŒè§£å†³äº† RRçº§åˆ«åœ¨å†™æ•°æ®æ—¶çš„å¹»è¯»é—®é¢˜ã€‚</p>
<p>åä¸€ã€Serializable</p>
<p>è¿™ä¸ªçº§åˆ«å¾ˆç®€å•ï¼Œè¯»åŠ å…±äº«é”ï¼Œå†™åŠ æ’ä»–é”ï¼Œè¯»å†™äº’æ–¥ã€‚ä½¿ç”¨çš„æ‚²è§‚é”çš„ç†è®ºï¼Œå®ç°ç®€å•ï¼Œæ•°æ®æ›´åŠ å®‰å…¨ï¼Œä½†æ˜¯å¹¶å‘èƒ½åŠ›éå¸¸å·®ã€‚å¦‚æœä½ çš„ä¸šåŠ¡å¹¶å‘çš„ç‰¹åˆ«å°‘æˆ–è€…æ²¡æœ‰å¹¶å‘ï¼ŒåŒæ—¶åˆè¦æ±‚æ•°æ®åŠæ—¶å¯é çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§æ¨¡å¼ã€‚</p>
<blockquote>
<p>è¿™é‡Œè¦åæ§½ä¸€å¥ï¼Œä¸è¦çœ‹åˆ° selectå°±è¯´ä¸ä¼šåŠ é”äº†ï¼Œåœ¨Serializableè¿™ä¸ªçº§åˆ«ï¼Œè¿˜æ˜¯ä¼šåŠ é”çš„ï¼</p>
</blockquote>
</blockquote>
<p><a href="https://juejin.cn/post/6920072842935533576">Javaé¢è¯•å¿…é—®çš„MySQLé”ä¸äº‹åŠ¡éš”ç¦»çº§åˆ«</a></p>
<p><a href="https://cloud.tencent.com/developer/article/1121737">æ•°æ®åº“äº‹åŠ¡ã€éš”ç¦»çº§åˆ«å’Œé”ACIDçš„çœŸå®å«ä¹‰éš”ç¦»çº§åˆ«å’Œå¹¶å‘æ§åˆ¶MySQLå’ŒPostgreSQLå¯¹æ¯”å¦‚ä½•å†™ä»£ç </a>ç•¥è¯»</p>
<h3 id="b-jdbc">B. JDBC</h3>
<h4 id="1-jdbcäº‹åŠ¡çš„æ§åˆ¶æµç¨‹">1. JDBCäº‹åŠ¡çš„æ§åˆ¶æµç¨‹</h4>
<p>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         JDBC åŸå§‹å†™æ³•         â”‚       Spring @Transactional     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Connection conn =            â”‚ @Transactional                  â”‚
â”‚   dataSource.getConnection();â”‚ public void doBiz() {           â”‚
â”‚ conn.setAutoCommit(false);   â”‚     userRepo.save(user);       â”‚
â”‚ try {                        â”‚     orderRepo.save(order);     â”‚
â”‚     // æ‰§è¡Œä¸šåŠ¡SQL           â”‚ }                               â”‚
â”‚     conn.commit();           â”‚ // Spring è‡ªåŠ¨ç®¡ç†äº‹åŠ¡          â”‚
â”‚ } catch (Exception e) {      â”‚                                  â”‚
â”‚     conn.rollback();         â”‚                                  â”‚
â”‚ } finally {                  â”‚                                  â”‚
â”‚     conn.close();            â”‚                                  â”‚
â”‚ }                            â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</p>
<h4 id="2-å­¦ä¹ åˆ—è¡¨">2. å­¦ä¹ åˆ—è¡¨</h4>
<p>Once a connection is obtained we can interact with the database.
The JDBC Statement, CallableStatement, and PreparedStatement interfaces define the methods
and properties that enable you to send SQL or PL/SQL commands and receive data from your database.</p>
<p>They also define methods that help bridge data type differences between Java and SQL data types used in a database.</p>
<p>The following table provides a summary of each interface&rsquo;s purpose to decide on the interface to use.</p>
<table>
<thead>
<tr>
<th style="text-align:left">Interfaces</th>
<th style="text-align:left">Recommended Use</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Statement</td>
<td style="text-align:left">Use this for general-purpose access to your database. Useful when you are using static SQL statements at runtime. The Statement interface cannot accept parameters.</td>
</tr>
<tr>
<td style="text-align:left">PreparedStatement</td>
<td style="text-align:left">Use this when you plan to use the SQL statements many times. The PreparedStatement interface accepts input parameters at runtime.</td>
</tr>
<tr>
<td style="text-align:left">CallableStatement</td>
<td style="text-align:left">Use this when you want to access the database stored procedures. The CallableStatement interface can also accept runtime input parameters.</td>
</tr>
</tbody>
</table>
<h2 id="xii-utils">XII. UTILS</h2>
<hr>
<p>å¾ˆå¤šæºç ä¸­æ€»ç»“çš„Utilså¾ˆå¥½ç”¨, å¤šå­¦ä¹ ä¸€ä¸‹</p>
<h3 id="åˆ¤æ–­ç±»å®ä¾‹ä¸­çš„å„ä¸ªå±æ€§æ˜¯å¦æœ‰null">åˆ¤æ–­ç±»å®ä¾‹ä¸­çš„å„ä¸ªå±æ€§æ˜¯å¦æœ‰null</h3>

  
    
  
  
  
  


<figure class="highlight  language-">
  <figcaption>
    
      <span>Utils.java</span>
    
  </figcaption>
  <table>
    <tbody>
      <tr>
        <td class="gutter">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre>
        </td>
        <td class="code">
          <pre class="code-highlight language- "><code class="">private boolean hasNull(Object obj) {
    if (obj == null) {
        return true;
    }
    final Field[] fields = ClassUtil.getDeclaredFields(obj.getClass());
    Object fieldValue = null;
    for (Field field : fields) {
        field.setAccessible(true);
        try {
            fieldValue = field.get(obj);
        } catch (Exception e) {
            e.printStackTrace();
        }
        if (null == fieldValue) {
            return true;
        }
    }
    return false;
}</code></pre>
        </td>
      </tr>
    </tbody>
  </table>
</figure>

<h3 id="å…¼å®¹å¤šç§æ—¶é—´æ ¼å¼çš„è¾“å…¥">å…¼å®¹å¤šç§æ—¶é—´æ ¼å¼çš„è¾“å…¥</h3>


  
  
  
  
  

  
  
  
  
  


  
    
  
  
    
  

<figure class="codeblock codeblock--tabbed">
  <figcaption>
    
      <span><a href="java">DateForamtUtil</a></span>
    
    <ul class="tabs">
      
        <li class="tab active">util</li>
      
        <li class="tab ">invoke</li>
      
    </ul>
  </figcaption>
  <div class="tabs-content">
    
      
      <figure class="highlight language-util util" style="display: block;">
        <table>
          <tbody>
            <tr>
              <td class="gutter">
                <pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br></pre>
              </td>
              <td class="code">
                <pre class="code-highlight language-util util"><code class="util">import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.HashMap;
import java.util.regex.Pattern;

/**
 * author : toby
 * e-mail : 13128826083@163.com
 * time : 2018/2/2
 * desc :
 */
public class DateFormatUtil {

    /**
     * æ ¼å¼åŒ–æ—¶é—´
     *
     * @param dateStr
     * @return
     */
    public static String dateRegFormat(String dateStr) {
        HashMap&lt;String, String&gt; dateRegFormat = new HashMap&lt;&gt;();
        // 2014å¹´3æœˆ12æ—¥ 13æ—¶5åˆ†34ç§’ï¼Œ2014-03-12 12:05:34ï¼Œ2014/3/12 12:5:34
        dateRegFormat.put(&#34;^\\d{4}\\D&#43;\\d{1,2}\\D&#43;\\d{1,2}\\D&#43;\\d{1,2}\\D&#43;\\d{1,2}\\D&#43;\\d{1,2}\\D*$&#34;, &#34;yyyy-MM-dd-HH-mm-ss&#34;);

        // 2014-03-12 12:05ï¼Œ2014-3-12 12:5
        dateRegFormat.put(&#34;^\\d{4}\\D&#43;\\d{1,2}\\D&#43;\\d{1,2}\\D&#43;\\d{1,2}\\D&#43;\\d{1,2}\\D*$&#34;, &#34;yyyy-MM-dd-HH-mm&#34;);

        // 2014-03-12
        dateRegFormat.put(&#34;^\\d{4}\\D&#43;\\d{1,2}\\D&#43;\\d{1,2}$&#34;, &#34;yyyy-MM-dd&#34;);

        DateFormat formatter1 = new SimpleDateFormat(&#34;yyyy-MM-dd HH:mm:ss&#34;);
        DateFormat formatter2;
        String dateReplace;
        String strSuccess = &#34;&#34;;
        try {
            for (String key : dateRegFormat.keySet()) {
                if (Pattern.compile(key).matcher(dateStr).matches()) {
                    formatter2 = new SimpleDateFormat(dateRegFormat.get(key));
                    dateReplace = dateStr.replaceAll(&#34;\\D&#43;&#34;, &#34;-&#34;);
                    strSuccess = formatter1.format(formatter2.parse(dateReplace));
                    break;
                }
            }
        } catch (Exception e) {
            System.err.println(&#34;---------æ—¥æœŸæ ¼å¼æ— æ•ˆ-----------&#34; &#43; dateStr);
            throw new Exception(&#34;æ—¥æœŸæ ¼å¼æ— æ•ˆ&#34;);
        } finally {
            return strSuccess;
        }
    }
}</code></pre>
              </td>
            </tr>
          </tbody>
        </table>
      </figure>
    
      
      <figure class="highlight language-invoke invoke" style="display: none;">
        <table>
          <tbody>
            <tr>
              <td class="gutter">
                <pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br></pre>
              </td>
              <td class="code">
                <pre class="code-highlight language-invoke invoke"><code class="invoke">private void testDateFormat() {
    String[] dateStrArray = new String[]{
        &#34;2018-03-12 12:05:34&#34;,
        &#34;2018-03-12 12:05&#34;,
        &#34;2018-3-12 12:5:34&#34;,
        &#34;2018-3-12 12:5&#34;,
        &#34;2018-3-12&#34;,
        &#34;2018-03-12&#34;,
        &#34;2018/03/12 12:05:34&#34;,
        &#34;2018/3/12 12:5:34&#34;,
        &#34;2018/03/12 12:05&#34;,
        &#34;2018/3/12 12:5&#34;,
        &#34;2018/03/12&#34;,
        &#34;2018å¹´3æœˆ12æ—¥ 13æ—¶5åˆ†34ç§’&#34;,
        &#34;2018å¹´3æœˆ12æ—¥ 13æ—¶5åˆ†&#34;,
        &#34;2018å¹´03æœˆ12æ—¥ 13æ—¶05åˆ†34ç§’&#34;
    };
    for (int i = 0; i &lt; dateStrArray.length; i&#43;&#43;) {
        Log.d(&#34;----index----&gt;&#34; &#43; i, DateFormatUtil.dateRegFormat(dateStrArray[i]));
    }
}</code></pre>
              </td>
            </tr>
          </tbody>
        </table>
      </figure>
    
  </div>
</figure>

<h2 id="xiii-miscellaneous">XIII. MISCELLANEOUS</h2>
<hr>
<p><strong>EXCEPTION</strong></p>
<p>TryCatchFinally</p>
<p>é¦–å…ˆçœ‹ä¸ªä¾‹å­ï¼š</p>


  
  
  
  
  

  
  
  
  
  


  
    
  
  

<figure class="codeblock codeblock--tabbed">
  <figcaption>
    
      <span>tryCatchFinally</span>
    
    <ul class="tabs">
      
        <li class="tab active">return2</li>
      
        <li class="tab ">return3</li>
      
    </ul>
  </figcaption>
  <div class="tabs-content">
    
      
      <figure class="highlight language-return2 return2" style="display: block;">
        <table>
          <tbody>
            <tr>
              <td class="gutter">
                <pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br></pre>
              </td>
              <td class="code">
                <pre class="code-highlight language-return2 return2"><code class="return2">public class TestReturn {
    public int test() {
        int x  = 1;
        try {
            return &#43;&#43;x;
        } catch(Exception e) {

        } finally {
            &#43;&#43;x;
        }

        return x;
    }

    public static void main(String[] args) {
        TestReturn t = new TestReturn();
        int result = t.test();
        System.out.println(result);
    }
}

// è¾“å‡ºç»“æœæ˜¯2</code></pre>
              </td>
            </tr>
          </tbody>
        </table>
      </figure>
    
      
      <figure class="highlight language-return3 return3" style="display: none;">
        <table>
          <tbody>
            <tr>
              <td class="gutter">
                <pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br></pre>
              </td>
              <td class="code">
                <pre class="code-highlight language-return3 return3"><code class="return3">public class TestReturn {
    public int test() {
        int x  = 1;
        try {
            return &#43;&#43;x;
        } catch(Exception e) {

        } finally {
            return &#43;&#43;x;
        }
    }

    public static void main(String[] args) {
        TestReturn t = new TestReturn();
        int result = t.test();
        System.out.println(result);
    }
}

// è¾“å‡ºç»“æœæ˜¯3</code></pre>
              </td>
            </tr>
          </tbody>
        </table>
      </figure>
    
  </div>
</figure>

<p>æŸ¥é˜…èµ„æ–™å¾—åˆ°ä¸‹é¢çš„è¯´æ³•ï¼š</p>
<p>å½“tryè¯­å¥é€€å‡ºæ—¶è‚¯å®šä¼šæ‰§è¡Œfinallyè¯­å¥ã€‚è¿™ç¡®ä¿äº†å³ä½¿å‘äº†ä¸€ä¸ªæ„æƒ³ä¸åˆ°çš„å¼‚å¸¸ä¹Ÿä¼šæ‰§è¡Œfinallyè¯­å¥å—ã€‚
ä½†æ˜¯finallyçš„ç”¨å¤„ä¸ä»…æ˜¯ç”¨æ¥å¤„ç†å¼‚å¸¸â€”â€”å®ƒå¯ä»¥è®©ç¨‹åºå‘˜ä¸ä¼šå› ä¸ºreturnã€continueã€æˆ–è€…breakè¯­å¥è€Œå¿½ç•¥äº†æ¸…ç†ä»£ç ã€‚
æŠŠæ¸…ç†ä»£ç æ”¾åœ¨finallyè¯­å¥å—é‡Œæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åšæ³•ï¼Œå³ä¾¿å¯èƒ½ä¸ä¼šæœ‰å¼‚å¸¸å‘ç”Ÿä¹Ÿè¦è¿™æ ·åšã€‚</p>
<div class="alert warning ">
  <p>æ³¨æ„ï¼Œå½“tryæˆ–è€…catchçš„ä»£ç åœ¨è¿è¡Œçš„æ—¶å€™ï¼ŒJVMé€€å‡ºäº†ã€‚é‚£ä¹ˆfinallyè¯­å¥å—å°±ä¸ä¼šæ‰§è¡Œã€‚åŒæ ·ï¼Œå¦‚æœçº¿ç¨‹åœ¨è¿è¡Œtryæˆ–è€…catchçš„ä»£ç æ—¶è¢«ä¸­æ–­äº†æˆ–è€…è¢«æ€æ­»äº†(killed)ï¼Œé‚£ä¹ˆfinallyè¯­å¥å¯èƒ½ä¹Ÿä¸ä¼šæ‰§è¡Œäº†ï¼Œå³ä½¿æ•´ä¸ªè¿ç”¨è¿˜ä¼šç»§ç»­æ‰§è¡Œã€‚</p>
</div>
<p>è¯´æ˜ï¼šå¦‚æœåœ¨tryè¯­å¥é‡Œæœ‰returnè¯­å¥ï¼Œfinallyè¯­å¥è¿˜æ˜¯ä¼šæ‰§è¡Œã€‚å®ƒä¼šåœ¨æŠŠæ§åˆ¶æƒè½¬ç§»åˆ°è¯¥æ–¹æ³•çš„è°ƒç”¨è€…æˆ–è€…æ„é€ å™¨å‰æ‰§è¡Œfinallyè¯­å¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨returnè¯­å¥æŠŠæ§åˆ¶æƒè½¬ç§»ç»™å…¶ä»–çš„æ–¹æ³•å‰ä¼šæ‰§è¡Œfinallyè¯­å¥ã€‚</p>
<p><strong>é‚£ä¹ˆç»“æœä¸ºä»€ä¹ˆæ˜¯3ä¸æ˜¯2å‘¢?</strong></p>
<p>å½“æ‰§è¡Œåˆ°<code>return ++x;</code>æ—¶ï¼Œjvmåœ¨æ‰§è¡Œå®Œ ++x åä¼šåœ¨å±€éƒ¨å˜é‡è¡¨é‡Œå¦å¤–åˆ†é…ä¸€ä¸ªç©ºé—´æ¥ä¿å­˜å½“å‰xçš„å€¼ã€‚<br>
ç°åœ¨è¿˜æ²¡æŠŠå€¼è¿”å›ç»™yï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œfinallyè¯­å¥é‡Œçš„è¯­å¥ã€‚ç­‰æ‰§è¡Œå®Œåå†æŠŠä¹‹å‰ä¿å­˜çš„å€¼**(æ˜¯2, ä¸æ˜¯x)**è¿”å›ç»™yã€‚æ‰€ä»¥å°±æœ‰äº†yæ˜¯2ä¸æ˜¯3çš„æƒ…å†µã€‚</p>
<p>å…¶å®è¿™é‡Œè¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½ åœ¨finallyé‡Œä¹Ÿç”¨äº†returnè¯­å¥ï¼Œæ¯”å¦‚<code>return +xx;</code>, é‚£ä¹ˆyä¼šæ˜¯3ã€‚<br>
å› ä¸ºè§„èŒƒè§„å®šäº†ï¼Œå½“tryå’Œfinallyé‡Œéƒ½æœ‰returnæ—¶ï¼Œä¼šå¿½ç•¥tryçš„returnï¼Œè€Œä½¿ç”¨finallyçš„returnã€‚</p>
<p>åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/wujingjing_crystal/article/details/52495189</p>
<p>THREAD</p>
<p>ThreadLocal</p>
<p>Thread Lock</p>
<p>ä¸€ã€ReentrantLockæ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ï¼Ÿ
äºŒã€ReentrantLockçš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ
ä¸‰ã€ReentrantLockå¯¹æ¯”äºSynchronizedæœ‰å“ªäº›ä¼˜ç¼ºç‚¹ï¼Ÿ
å››ã€ReentrantLockçš„ç®€å•ä½¿ç”¨</p>
<p>ä¸€ã€ReentrantLockæ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ï¼Ÿ
è¿™ä¸ªç±»æ˜¯JUCå·¥å…·åŒ…ä¸­å¯¹çº¿ç¨‹å®‰å…¨é—®é¢˜æä¾›çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œå®ƒä¸»è¦æ˜¯ç”¨æ¥ç»™å¯¹è±¡ä¸Šé”ï¼Œä¿è¯åŒä¸€æ—¶é—´è¿™èƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨è®¿é—®å½“å‰å¯¹è±¡ã€‚è¿™æ ·å¤„ç†æ˜¯ä¸ºäº†é˜²æ­¢å¦‚æœä¸€ä¸ªçº¿ç¨‹å¯¹æŸä¸ªå…¬å…±å˜é‡è¿›è¡Œäº†æ”¹å˜ï¼Œè€Œå…¶å®ƒçº¿ç¨‹è¯»å–æ—¶è¯»å‡ºæ¥çš„æ˜¯åŸæœ‰æ•°æ®å¯¼è‡´è„è¯»çš„é—®é¢˜ã€‚</p>
<p>äºŒã€ReentrantLockçš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ
ReentrantLockä¸»è¦æ˜¯é€šè¿‡åŒæ­¥é˜Ÿåˆ—å’ŒCASæœºåˆ¶æ¥å®ç°çš„ï¼Œå®ƒå®ç°çš„è¿‡ç¨‹ä¸­ä¸»è¦åŒ…å«ä¸‹é¢å‡ ä¸ªå±æ€§ï¼š</p>
<p>statusï¼šé”çŠ¶æ€ï¼Œ0è¡¨ç¤ºæ²¡æœ‰çº¿ç¨‹è·å–é”ï¼Œ1è¡¨ç¤ºå·²æœ‰çº¿ç¨‹è·å–é”
exclusiveOwnerThreadï¼šå½“å‰æŒæœ‰é”çš„çº¿ç¨‹
Nodeï¼šèŠ‚ç‚¹ï¼Œæ˜¯ReentrantLockå†…éƒ¨ç»´æŒçš„ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼ˆåŒæ­¥é˜»å¡é˜Ÿåˆ—ï¼‰çš„åŸºæœ¬æ„æˆ
å…·ä½“æµç¨‹</p>
<p>1ã€ä¸Šé”æ›´æ–°é”çŠ¶æ€ï¼šå½“Açº¿ç¨‹æŒæœ‰é”æ—¶ï¼Œä¼šé€šè¿‡CASå°†statusçŠ¶æ€ç½®ä¸º1ï¼Œå¹¶å°†Açº¿ç¨‹è‡ªèº«å­˜å…¥exclusiveOwnerThreadå±æ€§å½“ä¸­ï¼›
2ã€çº¿ç¨‹å…¥é˜Ÿï¼šè€Œåçº¿ç¨‹Bé€šè¿‡CASè·å–é”æ—¶å‘ç°æ— æ³•è·å–é”ï¼Œæ­¤æ—¶å°±ä¼šè·å–nodeä¿¡æ¯ï¼Œä½†æ˜¯ç”±äºnodeåŒå‘é“¾è¡¨æ˜¯nullæ‰€ä»¥ä¼šé€šè¿‡CASæ¥åˆ›å»ºä¸€ä¸ªåŒå‘é“¾è¡¨çš„headå¯¹è±¡ï¼Œä¹‹åå†æŠŠçº¿ç¨‹Bå°è£…æˆçš„NodeèŠ‚ç‚¹é€šè¿‡å°¾æ’æ³•æ¥å…¥åŒå‘é“¾è¡¨çš„å°¾éƒ¨ï¼›
3ã€çº¿ç¨‹é˜»å¡ï¼šå…¥é˜Ÿå®Œæˆåå†è°ƒç”¨parkæ–¹æ³•è¿›è¡Œé˜»å¡ï¼›
4ã€é‡Šæ”¾é”å¹¶æ›´æ–°é”çŠ¶æ€ï¼šå½“Açº¿ç¨‹é‡Šæ”¾é”æ—¶ä¼šå°†statuså±æ€§é‡ç½®ä¸º0ï¼Œä¸”æŠŠexclusiveOwnerThreadç½®ä¸ºnullï¼›
5ã€å”¤é†’çº¿ç¨‹ï¼šAçº¿ç¨‹é‡Šæ”¾é”å®Œæ¯•åä¼šè°ƒç”¨unparkæ–¹æ³•æ¥å”¤é†’åŒå‘é“¾è¡¨ä¸­ä¸‹ä¸€èŠ‚ç‚¹çš„çº¿ç¨‹B;</p>
<p>ä¸‰ã€ReentrantLockå¯¹æ¯”äºSynchronizedæœ‰å“ªäº›ä¼˜ç¼ºç‚¹ï¼Ÿ
1ã€ReentrantLockçš„é”çŠ¶æ€æ˜¯å¯è§çš„ï¼Œè€ŒSynchronizedçš„é”çŠ¶æ€æ˜¯ä¸å¯è§çš„ï¼›
2ã€ReentrantLockæ˜¯JDKå±‚é¢çš„å®ç°ï¼Œè€ŒSynchronizedæ˜¯JVMå±‚é¢çš„å®ç°ï¼›
3ã€ReentrantLockéœ€è¦æ‰‹åŠ¨é‡Šæ”¾é”ï¼Œè€ŒSynchronizedä¸éœ€è¦æ‰‹åŠ¨é‡Šæ”¾é”ï¼›
4ã€ReentrantLockå¯ä»¥æ˜¯éå…¬å¹³é”ä¹Ÿå¯ä»¥æ˜¯å…¬å¹³é”ï¼Œè€ŒSynchronizedåªèƒ½æ˜¯éå…¬å¹³é”ï¼›
5ã€ReentrantLockæ˜¯å¯è¢«ä¸­æ–­çš„ï¼Œè€ŒSynchronizedæ˜¯ä¸å¯è¢«ä¸­æ–­çš„ï¼›
6ã€Synchronizedåœ¨ç‰¹å®šæ¡ä»¶ä¸‹æ˜¯åæ¥çš„çº¿ç¨‹å…ˆè·å–é”ï¼Œè€ŒReentrantLockæ˜¯å…ˆæ¥çš„çº¿ç¨‹å…ˆè·å–é”ï¼›
å››ã€ReentrantLockçš„ç®€å•ä½¿ç”¨</p>
<p><a href="https://blog.csdn.net/sqL520lT/article/details/122096431">ç¤ºä¾‹</a>
<a href="https://www.cnblogs.com/huanshilang/p/16872660.html">ReentrantLockåŸç†</a></p>
              


            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://ivanhan0511.github.io/tags/java/">Java</a>

  <a class="tag tag--primary tag--small" href="https://ivanhan0511.github.io/tags/spring/">Spring</a>

                  </div>
                
              
            
            
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://ivanhan0511.github.io/post/cpp/" data-tooltip="C/C&#43;&#43;" aria-label="NEXT: C/C&#43;&#43;">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://ivanhan0511.github.io/post/software-architecture/" data-tooltip="Software Architecture" aria-label="PREVIOUS: Software Architecture">
          
              <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://ivanhan0511.github.io/post/java-spring/" title="Share on Facebook" aria-label="Share on Facebook">
          <i class="fab fa-facebook-square" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://ivanhan0511.github.io/post/java-spring/" title="Share on Twitter" aria-label="Share on Twitter">
          <i class="fab fa-twitter" aria-hidden="true"></i>
        </a>
      </li>
    
  
  
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#disqus_thread" aria-label="Leave a comment">
        <i class="far fa-comment"></i>
      </a>
    </li>
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Back to top">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


            
  
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
    <script type="text/javascript">
      var disqus_config = function() {
        this.page.url = 'https:\/\/ivanhan0511.github.io\/post\/java-spring\/';
        
          this.page.identifier = '\/post\/java-spring\/'
        
      };
      (function() {
        
        
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
          document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
          return;
        }
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = 'ivan-blog-disqus';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  


          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2025 <a href="https://github.com/ivanhan0511">Ivan Han</a>. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://ivanhan0511.github.io/post/cpp/" data-tooltip="C/C&#43;&#43;" aria-label="NEXT: C/C&#43;&#43;">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://ivanhan0511.github.io/post/software-architecture/" data-tooltip="Software Architecture" aria-label="PREVIOUS: Software Architecture">
          
              <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://ivanhan0511.github.io/post/java-spring/" title="Share on Facebook" aria-label="Share on Facebook">
          <i class="fab fa-facebook-square" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://ivanhan0511.github.io/post/java-spring/" title="Share on Twitter" aria-label="Share on Twitter">
          <i class="fab fa-twitter" aria-hidden="true"></i>
        </a>
      </li>
    
  
  
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#disqus_thread" aria-label="Leave a comment">
        <i class="far fa-comment"></i>
      </a>
    </li>
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Back to top">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


      </div>
      
<div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-times"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fivanhan0511.github.io%2Fpost%2Fjava-spring%2F" aria-label="Share on Facebook">
          <i class="fab fa-facebook-square" aria-hidden="true"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fivanhan0511.github.io%2Fpost%2Fjava-spring%2F" aria-label="Share on Twitter">
          <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>


    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-times"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.gravatar.com/avatar/0cac315e34e792213d5fa694dc39777b?s=110" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Ivan Han</h4>
    
      <div id="about-card-bio">I need <strong>slow down</strong></div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Software Engineer
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker-alt"></i>
        <br/>
        China
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://ivanhan0511.github.io/images/cover.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js" integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://ivanhan0511.github.io/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js"></script>


  
    <script async crossorigin="anonymous" defer integrity="sha512-gE8KAQyFIzV1C9+GZ8TKJHZS2s+n7EjNtC+IMRn1l5+WYJTHOODUM6JSjZhFhqXmc7bG8Av6XXpckA4tYhflnw==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/apache.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-EWROca+bote+7Oaaar1F6y74iZj1r1F9rm/ly7o+/FwJopbBaWtsFDmaKoZDd3QiGU2pGacBirHJNivmGLYrow==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/go.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-GDVzAn0wpx1yVtQsRWmFc6PhJiLBPdUic+h4GWgljBh904O3JU10fk9EKNpVyIoPqkFn54rgL2QBG4BmUTMpiQ==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/http.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-UgZlma8NzkrDb/NWgmLIcTrH7i/CSnLLDRFqCSNF5NGPpjKmzyM25qcoXGOup8+cDakKyaiTDd7N4dyH4YT+IA==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/less.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-lot9koe73sfXIrUvIPM/UEhuMciN56RPyBdOyZgfO53P2lkWyyXN7J+njcxIIBRV+nVDQeiWtiXg+bLAJZDTfg==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/nginx.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-Zd3e7XxHP00TD0Imr0PIfeM0fl0v95kMWuhyAS3Wn1UTSXTkz0OhtRgBAr4JlmADRgiXr4x7lpeUdqaGN8xIog==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/puppet.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-qtqDO052iXMSP+5d/aE/jMtL9vIIGvONgTJziC2K/ZIB1yEGa55WVxGE9/08rSQ62EoDifS9SWVGZ7ihSLhzMA==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/scss.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-1NmkjnEDnwwwcu28KoQF8vs3oaPFokQHbmbtwGhFfeDsQZtVFI8zW2aE9O8yMYdpdyKV/5blE4pSWw4Z/Sv97w==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/stylus.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-B2wSfruPjr8EJL6IIzQr1eAuDwrsfIfccNf/LCEdxELCgC/S/ZMt/Uvk80aD79m7IqOqW+Sw8nbkvha20yZpzg==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/swift.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-28oDiQZGKUVN6wQ7PSLPNipOcmkCALXKwOi7bnkyFf8QiMZQxG9EQoy/iiNx6Zxj2cG2SbVa4dXKigQhu7GiFw==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/yaml.min.js"></script>
  


<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>




    
  </body>
</html>

